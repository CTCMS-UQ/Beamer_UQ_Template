%%------------------------------------------------------------%%
% Beamer theme for the University of Queensland,               %
% based on the metropolis theme.                               %
%                                                              %
% Created by S. R. Tee, adapted by S. Sanderson                %
%                                                              %
% Defines colours:                                             %
%  Primary:               Secondary:                           %
%  - uqviolet             - uqpuple                            %
%  - uqmagenta            - uqlightgrey                        %
%  - uqcyan               - uqgrey                             %
%  - uqorange             - uqgold                             %
%  - uqblue               - uqyellow                           %
%  - uqgreen                                                   %
%                                                              %
%%------------------------------------------------------------%%

\usetheme{metropolis}
\RequirePackage{textpos}
\RequirePackage{xcolor}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Colour defines
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\definecolor{uqviolet}{RGB}{81,36,122}
\definecolor{uqmagenta}{RGB}{230,38,69}
\definecolor{uqcyan}{RGB}{0,162,199}
\definecolor{uqorange}{RGB}{235,96,43}
\definecolor{uqblue}{RGB}{64,133,198}
\definecolor{uqgreen}{RGB}{46,168,54}

\definecolor{uqpurple}{RGB}{150,42,139}
\definecolor{uqlightgrey}{RGB}{215,209,204}
\definecolor{uqgrey}{RGB}{153,148,144}
\definecolor{uqgold}{RGB}{200,174,115}
\definecolor{uqyellow}{RGB}{251,184,0}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Colour Theme
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\setbeamercolor*{structure}{bg=uqviolet!20,fg=uqviolet}

\setbeamercolor*{palette primary}{use=structure,fg=white,bg=structure.fg}
\setbeamercolor*{palette secondary}{use=structure,fg=white,bg=structure.fg!75}
\setbeamercolor*{palette tertiary}{use=structure,fg=white,bg=structure.fg!50!black}
\setbeamercolor*{palette quaternary}{fg=white,bg=black}

% Title Page Colours
\setbeamercolor*{title}{fg=uqviolet}
\setbeamercolor*{title separator}{fg=uqblue}
\setbeamercolor*{author}{fg=uqviolet}
\setbeamercolor*{date}{fg=uqviolet}
\setbeamercolor*{institute}{fg=uqviolet}

% Section Page Colours
\setbeamercolor*{section title}{fg=uqviolet}
\setbeamercolor*{section in toc}{fg=uqviolet}
\setbeamercolor*{section in toc shaded}{fg=uqviolet}
\setbeamercolor*{subsection title}{fg=uqviolet}
\setbeamercolor*{subsection in toc}{fg=uqviolet}
\setbeamercolor*{subsection in toc shaded}{fg=uqviolet}
\setbeamercolor*{progress bar in section page}{fg=uqblue,bg=uqlightgrey}

% Blocks
\setbeamercolor*{block title}{fg=uqviolet}
\setbeamercolor*{block body}{fg=black}

\setbeamercolor*{block title alerted}{fg=uqmagenta}
\setbeamercolor*{block body alerted}{fg=uqorange}

\setbeamercolor*{block title example}{fg=uqblue}
\setbeamercolor*{block body example}{fg=black}

% Items
\setbeamercolor*{item}{fg=black}
\setbeamercolor*{subitem}{fg=black}
\setbeamercolor*{subsubitem}{fg=black}

% Captions
\setbeamercolor*{caption}{fg=black}
\setbeamercolor*{caption name}{fg=uqviolet}

\setbeamercolor*{normal text}{fg=black}
\setbeamercolor*{alerted text}{fg=uqpurple}

% Less indent on first level bullet points
\setbeamertemplate{itemize/enumerate body begin}{\setlength{\leftmargini}{1.2em}}

% Frame Header
\colorlet{titleleft}{uqpurple}
\colorlet{titlemiddle}{uqpurple!50!uqviolet}
\colorlet{titleright}{uqviolet}

\makeatletter
\pgfdeclarehorizontalshading[titleleft,titlemiddle,titleright]
      {beamer@frametitleshade}{\paperheight}{
    color(0pt)=(titleleft);
    color(0.2\paperwidth)=(titlemiddle);
    color(0.65\paperwidth)=(titleright);
    color(\paperwidth)=(titleright)
  }
\makeatother

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Frame Header
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\makeatletter
\defbeamertemplate*{frametitle}{horizontal shading}
{%
  \nointerlineskip%
  \hbox{\leavevmode
    \advance\beamer@leftmargin by -12bp%
    \advance\beamer@rightmargin by -12bp%
    \beamer@tempdim=\textwidth%
    \advance\beamer@tempdim by \beamer@leftmargin%
    \advance\beamer@tempdim by \beamer@rightmargin%
    \hskip-\Gm@lmargin\hbox{%
      \setbox\beamer@tempbox=\hbox{\begin{minipage}[b]{\paperwidth}%
          \vbox{}\vskip-1ex%
          \leftskip0.3cm%
          \hskip1em
          \rightskip0.3cm plus1fil\leavevmode
          \insertframetitle%
          \ifx\insertframesubtitle\@empty%
            \strut\par%
          \else
            \par{\usebeamerfont*{framesubtitle}{\usebeamercolor[fg]{framesubtitle}\insertframesubtitle}\strut\par}%
          \fi%
          \nointerlineskip
          \vbox to .8ex{}%
          \end{minipage}}%
      \beamer@tempdim=\ht\beamer@tempbox%
      \advance\beamer@tempdim by 8pt%
      \begin{pgfpicture}{0pt}{0pt}{\paperwidth}{\beamer@tempdim}
        \usebeamercolor{titleright}
        \pgfpathrectangle{\pgfpointorigin}{\pgfpoint{\paperwidth}{\beamer@tempdim}}
        \pgfusepath{clip}
        \pgftext[left,base]{\pgfuseshading{beamer@frametitleshade}}
      \end{pgfpicture}
      \hskip-\paperwidth%
      \box\beamer@tempbox%
    }%
    \hskip-\Gm@rmargin%
  }%
}
\makeatother

% Logo
\addtobeamertemplate{frametitle}{}{%
\begin{textblock*}{100mm}(.78\textwidth,-.97cm)
\includegraphics[height=.96cm]{UQlogo}
\end{textblock*}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Fonts
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usefonttheme{professionalfonts} % using non standard fonts for beamer
